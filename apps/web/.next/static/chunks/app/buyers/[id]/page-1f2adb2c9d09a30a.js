(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[951],{5792:function(e,s,t){Promise.resolve().then(t.bind(t,8430))},8430:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return o}});var r=t(7573),a=t(7653),n=t(2859),l=t(7797),i=t(3287);function o(){let e=(0,n.useParams)();(0,n.useRouter)();let[s,t]=(0,a.useState)(null),[o,c]=(0,a.useState)(!0),[d,u]=(0,a.useState)({name:"",phone:"",email:"",address:"",notes:""});(0,a.useEffect)(()=>{e.id&&h()},[e.id]);let h=async()=>{try{let s=await fetch("/api/buyers/".concat(e.id)),r=await s.json();t(r),u({name:r.name||"",phone:r.phone||"",email:r.email||"",address:r.address||"",notes:r.notes||""})}catch(e){console.error("Error fetching buyer:",e)}finally{c(!1)}},m=async s=>{s.preventDefault();try{(await fetch("/api/buyers/".concat(e.id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)})).ok&&(h(),alert("Buyer updated successfully"))}catch(e){console.error("Error updating buyer:",e)}},x=async()=>{try{await fetch("/api/buyers/".concat(e.id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({incrementVisits:!0})}),h()}catch(e){console.error("Error incrementing visits:",e)}};return o?(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,r.jsx)(l.default,{}),(0,r.jsx)("main",{className:"container mx-auto px-4 py-8",children:"Loading..."})]}):s?(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,r.jsx)(l.default,{}),(0,r.jsxs)("main",{className:"container mx-auto px-4 py-8",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold",children:"Buyer Details"}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(i.Z,{phone:s.phone,recipientId:s.id,recipientType:"buyer",children:"WhatsApp"}),(0,r.jsx)("button",{onClick:x,className:"bg-blue-500 text-white px-4 py-2 rounded",children:"+1 Visit"})]})]}),(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow mb-6",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Edit Buyer"}),(0,r.jsxs)("form",{onSubmit:m,children:[(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Name *"}),(0,r.jsx)("input",{type:"text",required:!0,value:d.name,onChange:e=>u({...d,name:e.target.value}),className:"w-full px-3 py-2 border rounded"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Phone *"}),(0,r.jsx)("input",{type:"tel",required:!0,value:d.phone,onChange:e=>u({...d,phone:e.target.value}),className:"w-full px-3 py-2 border rounded"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Email"}),(0,r.jsx)("input",{type:"email",value:d.email,onChange:e=>u({...d,email:e.target.value}),className:"w-full px-3 py-2 border rounded"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Address"}),(0,r.jsx)("input",{type:"text",value:d.address,onChange:e=>u({...d,address:e.target.value}),className:"w-full px-3 py-2 border rounded"})]}),(0,r.jsxs)("div",{className:"col-span-2",children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Notes"}),(0,r.jsx)("textarea",{value:d.notes,onChange:e=>u({...d,notes:e.target.value}),className:"w-full px-3 py-2 border rounded",rows:3})]})]}),(0,r.jsx)("button",{type:"submit",className:"mt-4 bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700",children:"Update Buyer"})]})]}),(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Information"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"Visits Count"}),(0,r.jsx)("p",{className:"text-lg font-semibold",children:s.visitsCount})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"Created At"}),(0,r.jsx)("p",{className:"text-lg",children:new Date(s.createdAt).toLocaleDateString()})]})]})]})]})]}):(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,r.jsx)(l.default,{}),(0,r.jsx)("main",{className:"container mx-auto px-4 py-8",children:"Buyer not found"})]})}},7797:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return d}});var r=t(7573),a=t(2056),n=t.n(a),l=t(6072),i=t.n(l),o=t(2859),c=t(7653);function d(){let e=(0,o.useRouter)(),s=(0,o.usePathname)(),[t,a]=(0,c.useState)(!1),l=async()=>{try{await fetch("/api/auth/logout",{method:"POST"}),e.push("/auth/login"),e.refresh()}catch(e){console.error("Logout error:",e)}},d=[{href:"/",label:"Dashboard",icon:"\uD83D\uDCCA"},{href:"/buyers",label:"Buyers",icon:"\uD83D\uDC65"},{href:"/sellers",label:"Sellers",icon:"\uD83C\uDFE2"},{href:"/cars",label:"Cars",icon:"\uD83D\uDE97"},{href:"/leads",label:"Leads",icon:"\uD83D\uDCCB"},{href:"/followups",label:"Follow-ups",icon:"\uD83D\uDCDE"}],u=e=>s===e;return(0,r.jsx)("header",{className:"bg-white border-b border-gray-200 shadow-sm sticky top-0 z-50",children:(0,r.jsxs)("div",{className:"container mx-auto px-4",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,r.jsxs)(n(),{href:"/",className:"flex items-center space-x-2 group",children:[(0,r.jsx)("div",{className:"w-10 h-10 flex items-center justify-center",children:(0,r.jsx)(i(),{src:"/raghavendra-logo.png",alt:"Car Reseller CRM Logo",width:40,height:40,className:"object-contain"})}),(0,r.jsx)("span",{className:"text-xl font-bold text-gray-900 hidden sm:block",children:"Car Reseller CRM"})]}),(0,r.jsx)("nav",{className:"hidden md:flex items-center space-x-1",children:d.map(e=>(0,r.jsxs)(n(),{href:e.href,className:"px-4 py-2 rounded-lg text-sm font-medium transition-all ".concat(u(e.href)?"bg-blue-50 text-blue-700":"text-gray-700 hover:bg-gray-100 hover:text-gray-900"),children:[(0,r.jsx)("span",{className:"mr-1.5",children:e.icon}),e.label]},e.href))}),(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsxs)(n(),{href:"/auth/change-password",className:"hidden md:flex items-center px-3 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded-lg transition-colors",children:[(0,r.jsx)("span",{className:"mr-1.5",children:"⚙️"}),"Settings"]}),(0,r.jsxs)("button",{onClick:l,className:"flex items-center px-4 py-2 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-lg transition-colors shadow-sm hover:shadow",children:[(0,r.jsx)("span",{className:"mr-1.5",children:"\uD83D\uDEAA"}),(0,r.jsx)("span",{className:"hidden sm:inline",children:"Logout"})]}),(0,r.jsx)("button",{onClick:()=>a(!t),className:"md:hidden p-2 text-gray-700 hover:bg-gray-100 rounded-lg",children:(0,r.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t?(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"}):(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})})]})]}),t&&(0,r.jsx)("div",{className:"md:hidden border-t border-gray-200 py-2",children:(0,r.jsxs)("nav",{className:"flex flex-col space-y-1",children:[d.map(e=>(0,r.jsxs)(n(),{href:e.href,onClick:()=>a(!1),className:"px-4 py-2 rounded-lg text-sm font-medium transition-all ".concat(u(e.href)?"bg-blue-50 text-blue-700":"text-gray-700 hover:bg-gray-100"),children:[(0,r.jsx)("span",{className:"mr-2",children:e.icon}),e.label]},e.href)),(0,r.jsxs)(n(),{href:"/auth/change-password",onClick:()=>a(!1),className:"px-4 py-2 rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-100",children:[(0,r.jsx)("span",{className:"mr-2",children:"⚙️"}),"Settings"]})]})})]})})}},3287:function(e,s,t){"use strict";t.d(s,{Z:function(){return n}});var r=t(7573),a=t(7653);function n(e){let{phone:s,body:t="Hello",recipientId:n,recipientType:l,className:i="",children:o}=e,[c,d]=(0,a.useState)(!1),u=async()=>{if(!s){alert("Phone number is required");return}d(!0);try{let e=await fetch("/api/messages/wa-link",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({phone:s,body:t,recipientId:n,recipientType:l})}),r=await e.json();r.waLink?window.open(r.waLink,"_blank"):r.error&&alert(r.error)}catch(e){console.error("Error creating WA link:",e),alert("Failed to create WhatsApp link")}finally{d(!1)}};return(0,r.jsx)("button",{onClick:u,disabled:c,className:"px-3 py-1.5 text-sm text-white bg-[#25D366] hover:bg-[#20BA5A] rounded-md flex items-center gap-2 transition-colors shadow-sm ".concat(i," ").concat(c?"opacity-50 cursor-not-allowed":""),title:"Send WhatsApp message",children:c?"Loading...":(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.382 1.262.625 1.694.818.717.312 1.37.267 1.885.162.57-.115 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"})}),o||"WhatsApp"]})})}},1105:function(e,s,t){"use strict";Object.defineProperty(s,"__esModule",{value:!0}),function(e,s){for(var t in s)Object.defineProperty(e,t,{enumerable:!0,get:s[t]})}(s,{unstable_getImgProps:function(){return o},default:function(){return c}});let r=t(7675),a=t(6415),n=t(7720),l=t(5136),i=r._(t(6206)),o=e=>{(0,n.warnOnce)("Warning: unstable_getImgProps() is experimental and may change or be removed at any time. Use at your own risk.");let{props:s}=(0,a.getImgProps)(e,{defaultLoader:i.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!1}});for(let[e,t]of Object.entries(s))void 0===t&&delete s[e];return{props:s}},c=l.Image},8294:function(e,s,t){"use strict";var r=t(7653),a=Symbol.for("react.element"),n=Symbol.for("react.fragment"),l=Object.prototype.hasOwnProperty,i=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function c(e,s,t){var r,n={},c=null,d=null;for(r in void 0!==t&&(c=""+t),void 0!==s.key&&(c=""+s.key),void 0!==s.ref&&(d=s.ref),s)l.call(s,r)&&!o.hasOwnProperty(r)&&(n[r]=s[r]);if(e&&e.defaultProps)for(r in s=e.defaultProps)void 0===n[r]&&(n[r]=s[r]);return{$$typeof:a,type:e,key:c,ref:d,props:n,_owner:i.current}}s.Fragment=n,s.jsx=c,s.jsxs=c},7573:function(e,s,t){"use strict";e.exports=t(8294)},6072:function(e,s,t){e.exports=t(1105)},2056:function(e,s,t){e.exports=t(3040)},2859:function(e,s,t){e.exports=t(2988)}},function(e){e.O(0,[136,40,293,16,744],function(){return e(e.s=5792)}),_N_E=e.O()}]);