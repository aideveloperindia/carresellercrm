(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[429],{1359:function(e,t,r){Promise.resolve().then(r.bind(r,6472))},7797:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return d}});var s=r(7573),a=r(2056),n=r.n(a),l=r(6072),o=r.n(l),i=r(2859),c=r(7653);function d(){let e=(0,i.useRouter)(),t=(0,i.usePathname)(),[r,a]=(0,c.useState)(!1),l=async()=>{try{await fetch("/api/auth/logout",{method:"POST"}),e.push("/auth/login"),e.refresh()}catch(e){console.error("Logout error:",e)}},d=[{href:"/",label:"Dashboard",icon:"\uD83D\uDCCA"},{href:"/buyers",label:"Buyers",icon:"\uD83D\uDC65"},{href:"/sellers",label:"Sellers",icon:"\uD83C\uDFE2"},{href:"/cars",label:"Cars",icon:"\uD83D\uDE97"},{href:"/leads",label:"Leads",icon:"\uD83D\uDCCB"},{href:"/followups",label:"Follow-ups",icon:"\uD83D\uDCDE"}],u=e=>t===e;return(0,s.jsx)("header",{className:"bg-white border-b border-gray-200 shadow-sm sticky top-0 z-50",children:(0,s.jsxs)("div",{className:"container mx-auto px-4",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,s.jsxs)(n(),{href:"/",className:"flex items-center space-x-2 group",children:[(0,s.jsx)("div",{className:"w-10 h-10 flex items-center justify-center",children:(0,s.jsx)(o(),{src:"/raghavendra-logo.png",alt:"Car Reseller CRM Logo",width:40,height:40,className:"object-contain"})}),(0,s.jsx)("span",{className:"text-xl font-bold text-gray-900 hidden sm:block",children:"Car Reseller CRM"})]}),(0,s.jsx)("nav",{className:"hidden md:flex items-center space-x-1",children:d.map(e=>(0,s.jsxs)(n(),{href:e.href,className:"px-4 py-2 rounded-lg text-sm font-medium transition-all ".concat(u(e.href)?"bg-blue-50 text-blue-700":"text-gray-700 hover:bg-gray-100 hover:text-gray-900"),children:[(0,s.jsx)("span",{className:"mr-1.5",children:e.icon}),e.label]},e.href))}),(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsxs)(n(),{href:"/auth/change-password",className:"hidden md:flex items-center px-3 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded-lg transition-colors",children:[(0,s.jsx)("span",{className:"mr-1.5",children:"⚙️"}),"Settings"]}),(0,s.jsxs)("button",{onClick:l,className:"flex items-center px-4 py-2 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-lg transition-colors shadow-sm hover:shadow",children:[(0,s.jsx)("span",{className:"mr-1.5",children:"\uD83D\uDEAA"}),(0,s.jsx)("span",{className:"hidden sm:inline",children:"Logout"})]}),(0,s.jsx)("button",{onClick:()=>a(!r),className:"md:hidden p-2 text-gray-700 hover:bg-gray-100 rounded-lg",children:(0,s.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r?(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"}):(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})})]})]}),r&&(0,s.jsx)("div",{className:"md:hidden border-t border-gray-200 py-2",children:(0,s.jsxs)("nav",{className:"flex flex-col space-y-1",children:[d.map(e=>(0,s.jsxs)(n(),{href:e.href,onClick:()=>a(!1),className:"px-4 py-2 rounded-lg text-sm font-medium transition-all ".concat(u(e.href)?"bg-blue-50 text-blue-700":"text-gray-700 hover:bg-gray-100"),children:[(0,s.jsx)("span",{className:"mr-2",children:e.icon}),e.label]},e.href)),(0,s.jsxs)(n(),{href:"/auth/change-password",onClick:()=>a(!1),className:"px-4 py-2 rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-100",children:[(0,s.jsx)("span",{className:"mr-2",children:"⚙️"}),"Settings"]})]})})]})})}},6472:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return i}});var s=r(7573),a=r(7653),n=r(7797),l=r(2056),o=r.n(l);function i(){let[e,t]=(0,a.useState)([]),[r,l]=(0,a.useState)([]),[i,c]=(0,a.useState)([]),[d,u]=(0,a.useState)(!0),[x,h]=(0,a.useState)(!1),[m,p]=(0,a.useState)(!1),[g,f]=(0,a.useState)({buyerId:"",carId:"",source:"",status:"new",notes:""});(0,a.useEffect)(()=>{b()},[]);let b=async()=>{try{let[e,r,s]=await Promise.all([fetch("/api/leads"),fetch("/api/buyers"),fetch("/api/cars?status=available")]),[a,n,o]=await Promise.all([e.json(),r.json(),s.json()]),i=await Promise.all(a.map(async e=>{let t=e.buyerId?n.find(t=>t.id===e.buyerId):null,r=e.carId?o.find(t=>t.id===e.carId):null;return{...e,buyer:t,car:r}}));t(i),l(n),c(o.filter(e=>"available"===e.status))}catch(e){console.error("Error fetching data:",e)}finally{u(!1)}},y=async e=>{e.preventDefault(),p(!0);try{(await fetch("/api/leads",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...g,buyerId:g.buyerId||null,carId:g.carId||null})})).ok&&(h(!1),f({buyerId:"",carId:"",source:"",status:"new",notes:""}),b())}catch(e){console.error("Error creating lead:",e)}finally{p(!1)}},j=async(e,t)=>{try{await fetch("/api/leads/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:t})}),b()}catch(e){console.error("Error updating lead status:",e)}},v=async e=>{try{await fetch("/api/leads/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({incrementVisits:!0})}),b()}catch(e){console.error("Error incrementing visits:",e)}},N=e=>({new:"bg-blue-100 text-blue-800",contacted:"bg-yellow-100 text-yellow-800",qualified:"bg-purple-100 text-purple-800",converted:"bg-green-100 text-green-800",lost:"bg-red-100 text-red-800"})[e]||"bg-gray-100 text-gray-800";return d?(0,s.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100",children:[(0,s.jsx)(n.default,{}),(0,s.jsx)("main",{className:"container mx-auto px-4 py-8",children:(0,s.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})})})]}):(0,s.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100",children:[(0,s.jsx)(n.default,{}),(0,s.jsxs)("main",{className:"container mx-auto px-4 py-8",children:[(0,s.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-4xl font-bold text-gray-900 mb-2",children:"Leads"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Track sales opportunities and pipeline"})]}),(0,s.jsxs)("button",{onClick:()=>h(!x),className:"flex items-center gap-2 bg-gradient-to-r from-blue-600 to-indigo-600 text-white px-6 py-2.5 rounded-lg hover:from-blue-700 hover:to-indigo-700 transition-all shadow-md hover:shadow-lg font-medium",children:[(0,s.jsx)("span",{className:"text-lg",children:"+"}),x?"Cancel":"Create Lead"]})]}),x&&(0,s.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6 mb-6 border border-gray-100",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Create New Lead"}),(0,s.jsxs)("form",{onSubmit:y,className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Buyer *"}),(0,s.jsxs)("select",{required:!0,value:g.buyerId,onChange:e=>f({...g,buyerId:e.target.value}),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,s.jsx)("option",{value:"",children:"Select a buyer..."}),r.map(e=>(0,s.jsxs)("option",{value:e.id,children:[e.name," (",e.phone,")"]},e.id))]}),0===r.length&&(0,s.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["No buyers found. ",(0,s.jsx)(o(),{href:"/buyers",className:"text-blue-600 hover:underline",children:"Add a buyer first"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Car *"}),(0,s.jsxs)("select",{required:!0,value:g.carId,onChange:e=>f({...g,carId:e.target.value}),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,s.jsx)("option",{value:"",children:"Select a car..."}),i.map(e=>(0,s.jsxs)("option",{value:e.id,children:[e.brand," ",e.model," ",e.year&&"(".concat(e.year,")")," - ₹",e.price.toLocaleString()]},e.id))]}),0===i.length&&(0,s.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["No available cars. ",(0,s.jsx)(o(),{href:"/cars",className:"text-blue-600 hover:underline",children:"Add a car first"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Source"}),(0,s.jsxs)("select",{value:g.source,onChange:e=>f({...g,source:e.target.value}),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,s.jsx)("option",{value:"",children:"Select source..."}),(0,s.jsx)("option",{value:"website",children:"Website"}),(0,s.jsx)("option",{value:"referral",children:"Referral"}),(0,s.jsx)("option",{value:"walk-in",children:"Walk-in"}),(0,s.jsx)("option",{value:"phone",children:"Phone Call"}),(0,s.jsx)("option",{value:"social-media",children:"Social Media"}),(0,s.jsx)("option",{value:"other",children:"Other"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Status"}),(0,s.jsxs)("select",{value:g.status,onChange:e=>f({...g,status:e.target.value}),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,s.jsx)("option",{value:"new",children:"New"}),(0,s.jsx)("option",{value:"contacted",children:"Contacted"}),(0,s.jsx)("option",{value:"qualified",children:"Qualified"}),(0,s.jsx)("option",{value:"converted",children:"Converted"}),(0,s.jsx)("option",{value:"lost",children:"Lost"})]})]}),(0,s.jsxs)("div",{className:"md:col-span-2",children:[(0,s.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Notes"}),(0,s.jsx)("textarea",{value:g.notes,onChange:e=>f({...g,notes:e.target.value}),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:3,placeholder:"Additional notes about this lead..."})]})]}),(0,s.jsxs)("div",{className:"flex justify-end gap-3 pt-4",children:[(0,s.jsx)("button",{type:"button",onClick:()=>{h(!1),f({buyerId:"",carId:"",source:"",status:"new",notes:""})},className:"px-6 py-2.5 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 font-medium transition-colors",children:"Cancel"}),(0,s.jsx)("button",{type:"submit",disabled:m,className:"px-6 py-2.5 bg-gradient-to-r from-green-600 to-emerald-600 text-white rounded-lg hover:from-green-700 hover:to-emerald-700 transition-all shadow-md hover:shadow-lg font-medium disabled:opacity-50",children:m?"Creating...":"Create Lead"})]})]})]}),0===e.length?(0,s.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-12 text-center border border-gray-100",children:[(0,s.jsx)("div",{className:"text-6xl mb-4",children:"\uD83D\uDCCB"}),(0,s.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No leads found"}),(0,s.jsx)("p",{className:"text-gray-600 mb-6",children:"Create your first lead to start tracking sales opportunities"}),(0,s.jsxs)("button",{onClick:()=>h(!0),className:"inline-flex items-center gap-2 bg-gradient-to-r from-blue-600 to-indigo-600 text-white px-6 py-3 rounded-lg hover:from-blue-700 hover:to-indigo-700 transition-all shadow-md hover:shadow-lg font-medium",children:[(0,s.jsx)("span",{children:"+"})," Create First Lead"]})]}):(0,s.jsx)("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden border border-gray-100",children:(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"w-full",children:[(0,s.jsx)("thead",{className:"bg-gradient-to-r from-gray-50 to-gray-100 border-b border-gray-200",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Buyer"}),(0,s.jsx)("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Car"}),(0,s.jsx)("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Source"}),(0,s.jsx)("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Status"}),(0,s.jsx)("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Visits"}),(0,s.jsx)("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Created"}),(0,s.jsx)("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Actions"})]})}),(0,s.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(e=>(0,s.jsxs)("tr",{className:"hover:bg-gray-50 transition-colors",children:[(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:e.buyer?(0,s.jsx)(o(),{href:"/buyers/".concat(e.buyer.id),className:"text-blue-600 hover:text-blue-800 font-medium",children:e.buyer.name}):(0,s.jsx)("span",{className:"text-gray-400",children:"-"})}),(0,s.jsx)("td",{className:"px-6 py-4",children:e.car?(0,s.jsxs)("div",{className:"text-sm",children:[(0,s.jsxs)("div",{className:"font-medium text-gray-900",children:[e.car.brand," ",e.car.model,e.car.year&&" (".concat(e.car.year,")")]}),(0,s.jsxs)("div",{className:"text-gray-600",children:["₹",e.car.price.toLocaleString()]})]}):(0,s.jsx)("span",{className:"text-gray-400",children:"-"})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-gray-600",children:e.source||(0,s.jsx)("span",{className:"text-gray-400",children:"-"})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsxs)("select",{value:e.status,onChange:t=>j(e.id,t.target.value),className:"px-3 py-1.5 rounded-lg text-sm font-medium border-0 focus:outline-none focus:ring-2 focus:ring-blue-500 ".concat(N(e.status)),children:[(0,s.jsx)("option",{value:"new",children:"New"}),(0,s.jsx)("option",{value:"contacted",children:"Contacted"}),(0,s.jsx)("option",{value:"qualified",children:"Qualified"}),(0,s.jsx)("option",{value:"converted",children:"Converted"}),(0,s.jsx)("option",{value:"lost",children:"Lost"})]})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsx)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-blue-100 text-blue-800",children:e.visitsCount})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:new Date(e.createdAt).toLocaleDateString()}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsx)("button",{onClick:()=>v(e.id),className:"px-3 py-1.5 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 transition-colors text-sm font-medium",children:"+1 Visit"})})]},e.id))})]})})}),e.length>0&&(0,s.jsxs)("div",{className:"mt-6 text-center text-sm text-gray-600",children:["Showing ",(0,s.jsx)("span",{className:"font-semibold text-gray-900",children:e.length})," ",1===e.length?"lead":"leads"]})]})]})}},1105:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{unstable_getImgProps:function(){return i},default:function(){return c}});let s=r(7675),a=r(6415),n=r(7720),l=r(5136),o=s._(r(6206)),i=e=>{(0,n.warnOnce)("Warning: unstable_getImgProps() is experimental and may change or be removed at any time. Use at your own risk.");let{props:t}=(0,a.getImgProps)(e,{defaultLoader:o.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!1}});for(let[e,r]of Object.entries(t))void 0===r&&delete t[e];return{props:t}},c=l.Image},8294:function(e,t,r){"use strict";var s=r(7653),a=Symbol.for("react.element"),n=Symbol.for("react.fragment"),l=Object.prototype.hasOwnProperty,o=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,r){var s,n={},c=null,d=null;for(s in void 0!==r&&(c=""+r),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(d=t.ref),t)l.call(t,s)&&!i.hasOwnProperty(s)&&(n[s]=t[s]);if(e&&e.defaultProps)for(s in t=e.defaultProps)void 0===n[s]&&(n[s]=t[s]);return{$$typeof:a,type:e,key:c,ref:d,props:n,_owner:o.current}}t.Fragment=n,t.jsx=c,t.jsxs=c},7573:function(e,t,r){"use strict";e.exports=r(8294)},6072:function(e,t,r){e.exports=r(1105)},2056:function(e,t,r){e.exports=r(3040)},2859:function(e,t,r){e.exports=r(2988)}},function(e){e.O(0,[136,40,293,16,744],function(){return e(e.s=1359)}),_N_E=e.O()}]);