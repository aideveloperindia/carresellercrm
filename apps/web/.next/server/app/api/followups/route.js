"use strict";(()=>{var e={};e.id=581,e.ids=[581],e.modules={2934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},4300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},2781:e=>{e.exports=require("stream")},3837:e=>{e.exports=require("util")},8430:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>g,originalPathname:()=>x,patchFetch:()=>w,requestAsyncStorage:()=>f,routeModule:()=>p,serverHooks:()=>m,staticGenerationAsyncStorage:()=>h,staticGenerationBailout:()=>y});var n={};r.r(n),r.d(n,{GET:()=>c,POST:()=>d});var o=r(2390),a=r(1498),s=r(9308),l=r(7024),u=r(4099),i=r(1710);async function c(e){try{if(!await (0,i.fM)())return l.Z.json({error:"Unauthorized"},{status:401});let t=e.nextUrl.searchParams.get("filter")||"all",r={deleted:!1},n=new Date,o=new Date(n.getFullYear(),n.getMonth(),n.getDate()),a=new Date(o);a.setDate(a.getDate()+1),"today"===t?(r.scheduledAt={gte:o,lt:a},r.completed=!1):"pending"===t?(r.completed=!1,r.scheduledAt={gte:n}):"overdue"===t&&(r.completed=!1,r.scheduledAt={lt:n});let s=await u._.followUp.findMany({where:r,orderBy:{scheduledAt:"asc"}});return l.Z.json(s)}catch(e){return console.error("Get followups error:",e),l.Z.json({error:"Internal server error"},{status:500})}}async function d(e){try{if(!await (0,i.fM)())return l.Z.json({error:"Unauthorized"},{status:401});let{leadId:t,buyerId:r,sellerId:n,carId:o,type:a,scheduledAt:s,notes:c}=await e.json();if(!a||!s)return l.Z.json({error:"Type and scheduledAt are required"},{status:400});let d=await u._.followUp.create({data:{leadId:t||null,buyerId:r||null,sellerId:n||null,carId:o||null,type:a,scheduledAt:new Date(s),notes:c||null}});return l.Z.json(d,{status:201})}catch(e){return console.error("Create followup error:",e),l.Z.json({error:"Internal server error"},{status:500})}}let p=new o.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/followups/route",pathname:"/api/followups",filename:"route",bundlePath:"app/api/followups/route"},resolvedPagePath:"/Users/nandagiriaditya/Documents/carresellercrm/apps/web/app/api/followups/route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:f,staticGenerationAsyncStorage:h,serverHooks:m,headerHooks:g,staticGenerationBailout:y}=p,x="/api/followups/route";function w(){return(0,s.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:h})}},1710:(e,t,r)=>{r.d(t,{Oe:()=>d,Rf:()=>m,WX:()=>f,c_:()=>c,fM:()=>g,fT:()=>p,y$:()=>h});var n=r(7882),o=r.n(n),a=r(9814),s=r.n(a),l=r(822);let u=process.env.JWT_SECRET||"change-me-in-production",i="crcrm_session";async function c(e){return o().hash(e,10)}async function d(e,t){return o().compare(e,t)}function p(e){return s().sign(e,u,{expiresIn:"8h"})}function f(e){try{return s().verify(e,u)}catch(e){return null}}function h(e){return[`${i}=${e}`,"Max-Age=28800","Path=/","Secure","SameSite=Strict","HttpOnly"].filter(Boolean).join("; ")}function m(){return[`${i}=`,"Max-Age=0","Path=/","Secure","SameSite=Strict","HttpOnly"].filter(Boolean).join("; ")}async function g(){let e=(0,l.cookies)(),t=e.get(i)?.value;if(!t)return null;let r=f(t);return r?{id:r.adminId,email:r.email}:null}},4099:(e,t,r)=>{r.d(t,{_:()=>o});let n=require("@prisma/client"),o=globalThis.prisma??new n.PrismaClient({log:["error"]})}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[975,683,587],()=>r(8430));module.exports=n})();